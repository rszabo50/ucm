# UCM - Urwid Connection Manager

## Quick Start

UCM provides a terminal-based interface for managing SSH connections and Docker containers.

### Views

* **SSH View** - Manage and connect to SSH hosts
* **Docker View** - Access running Docker containers
* **Swarm View** - Docker Swarm services (if configured)

Switch views using the radio buttons in the header or Tab + arrow keys.

## Keyboard Shortcuts

### Global Shortcuts (All Views)

* `q` - Quit UCM
* `?` - Show this help dialog
* `Tab` - Cycle between UI elements
* `Esc` - Close dialogs

### Navigation

* `↑` or `k` - Move up one row
* `↓` or `j` - Move down one row
* `Page Up` - Scroll up one page
* `Page Down` - Scroll down one page
* `Home` - Jump to first item
* `End` - Jump to last item

### Actions

#### SSH View
* `Enter` - Connect to selected SSH host
* `c` - Connect to selected SSH host
* `f` - Toggle favorite status (marked with ★)
* `F` - Filter to show only favorites
* `r` - Sort by recently used
* `L` - Quick connect to last used connection
* `i` - Show connection info
* `Double-click` - Quick connect (mouse)

#### Docker View
* `Enter` - Connect to container
* `c` - Connect to selected container
* `i` - Inspect container details
* `Double-click` - Quick connect (mouse)

#### Docker Swarm View
* `c` or `b` - Connect with bash
* `s` - Connect with sh
* `i` - Inspect service/container

### Filtering and Sorting

* `/` - Activate filter mode (label shows "Filter [/]:" when active)
* Type text to search connections when filter is active
* `Esc` - Deactivate filter mode and return to list navigation
* Filter works on: name, address, user, category (SSH)
* Filter works on: container ID, name, image (Docker)
* `Backspace` - Remove filter characters
* `Ctrl+U` - Clear entire filter text
* `F` - Toggle favorites-only filter (shows [FAV] when active)
* `r` - Toggle recently used sorting (shows [RECENT] when active)

**Note**: The filter requires explicit activation with `/` to prevent accidental text entry. This allows you to use keyboard shortcuts (f, r, L, etc.) without accidentally typing in the filter box.

## Mouse Controls

* **Click** - Select a connection/container
* **Double-click** - Connect immediately
* **Click buttons** - Activate buttons (Help, Quit)
* **Click radio buttons** - Switch between views
* **Scroll wheel** - Scroll through lists

## SSH Configuration

Edit `~/.ucm/ssh_connections.yml` to add SSH connections.

### Required Fields
* `name` - Unique identifier
* `address` - Hostname or IP address

### Optional Fields
* `user` - SSH username (default: current user)
* `port` - SSH port (default: 22)
* `identity` - Path to SSH key file
* `options` - Additional SSH options
* `category` - Grouping label

### Example Configuration

```yaml
# Minimal connection
- name: webserver
  address: web.example.com

# Full configuration
- name: production-db
  address: db.example.com
  user: admin
  port: 2222
  identity: ~/.ssh/prod-key.pem
  options: -X
  category: production
```

## Connection History and Favorites

UCM automatically tracks your connection usage and allows marking favorites.

### History Tracking
* All connections are recorded with timestamps and use counts
* History is limited to the last 100 connections
* Most frequently used connections are tracked
* View stats and history in `~/.ucm/history.yml`

### Favorites
* Press `f` to toggle favorite status on any SSH connection
* Favorites are marked with a ★ symbol in the list
* Favorites persist across sessions
* Stored in `~/.ucm/favorites.yml`

### Benefits
* Quickly identify your most-used connections
* Mark important servers as favorites for easy identification
* Track connection patterns and usage

## Docker Integration

UCM automatically detects running Docker containers.

### Requirements
* Docker installed and running
* User has permission to run `docker ps`

### Container Actions
* `c` - Connect with bash/sh
* `i` - View container details
* `Enter` - Quick connect

UCM tries `bash` first, then falls back to `sh` if bash isn't available.

## Tips and Tricks

### Faster Navigation
* Use `j`/`k` (Vim-style) instead of arrow keys
* Filter to narrow down the list quickly
* Use `Tab` to move between UI sections

### Efficient Filtering
* Press `/` to activate filter mode, then type partial names
* Example: "web" finds "webserver1", "webserver2"
* Use categories to group connections
* Clear filter with `Ctrl+U` or press `Esc` to exit filter mode

### SSH Config Integration
* UCM respects `~/.ssh/config` settings
* Set common options there to avoid repetition
* Identity files, ports, and options can be configured globally

### Command-Line Options

```bash
# Show version
ucm --version

# Use custom config directory
ucm --config-dir ~/my-configs

# Enable debug logging
ucm --log-level DEBUG

# Custom log file
ucm --log-file ~/ucm.log
```

## Common Workflows

### Quick Connect
1. Launch UCM
2. Press `/` to activate filter
3. Type to find host
4. Press Enter when filtered to one result

### Container Access
1. Switch to Docker view (click or Tab)
2. Find container (filter if needed)
3. Press `c` or `Enter` to connect

### Multiple Environments
* Use `--config-dir` for separate configs
* Create aliases: `alias ucm-prod='ucm --config-dir ~/.ucm-prod'`

## Troubleshooting

### Configuration Errors
* Check error message on startup
* Verify required fields (name, address)
* Validate port range (1-65535)

### Connection Issues
* Test SSH manually: `ssh user@host`
* Check SSH key permissions: `chmod 600 ~/.ssh/key.pem`
* Enable debug logging: `ucm --log-level DEBUG`

### Docker Not Showing
* Verify Docker is running: `docker ps`
* Check user permissions: add user to docker group
* Ensure Docker is in PATH

## Documentation

* **Full User Guide**: See USER_GUIDE.md in repository
* **Development**: See DEVELOPMENT.md for contributing
* **Issues**: https://github.com/rszabo50/ucm/issues

## License

Released under GNU GPLv3.

If you find UCM useful, please donate to your local charities!

## About

UCM is inspired by nccm (NCurses ssh Connection Manager) but built with urwid for enhanced mouse support and modern terminal UI.

**Repository**: https://github.com/rszabo50/ucm

---

Press `Esc` or click `Cancel` to close this help dialog
